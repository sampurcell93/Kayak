// Generated by CoffeeScript 1.6.3
(function() {
  window.WorkSpace = Backbone.Router.extend({
    routes: {
      "business/:id": "showBusiness",
      "business/:id/full": "fullBusiness"
    },
    fullBusiness: function(id) {
      var b;
      b = window.businesses._byId[id];
      if (b) {
        return launchModal(new window.GMapBusiness({
          model: b
        }).render().el, {
          destroyHash: true
        });
      }
    },
    showBusiness: function(id) {
      var b;
      b = window.businesses._byId[id];
      if (b) {
        return window.businesses.list.selectItem(b);
      }
    }
  });

  $(function() {
    window.launchModal = function(content, options) {
      var defaults, modal;
      destroyModal(true);
      defaults = {
        close: true,
        destroyHash: false
      };
      options = _.extend(defaults, options);
      modal = $("<div />").addClass("modal");
      if ($.isArray(content)) {
        _.each(content, function(item) {
          return modal.append(item);
        });
      } else {
        modal.html(content);
      }
      if (options.close !== false) {
        modal.prepend("<i class='close-modal icon-cancel'></i>");
        modal.find(".close-modal").on("click", function() {
          $(document.body).removeClass("active-modal");
          modal.remove();
          if (options.destroyHash === true) {
            return window.location.hash = "";
          }
        });
      }
      $(document.body).addClass("active-modal").append(modal);
      return modal;
    };
    return window.destroyModal = function(existing) {
      return $(".modal").fadeOut("fast", function() {
        if (existing !== true) {
          return $(document.body).removeClass("active-modal");
        }
      });
    };
  });

}).call(this);
